   генетический   алгоритм   в   разработка   игра   общий   статья   программирование   игра   новость   статья   код   арт   дизайн   индустрия   подсказка   термин   FAQ   страница   сообщество   форум   качалка   участник   пользователь   темный   тема   публикация   проект   форум   работа   входить   программированиестатьиобщий   генетический   алгоритм   в   разработка   игра   автор   I   I   привет   детишки   сегодня   я   хотеть   рассказывать   вы   сказка   про   генетический   алгоритм   и   их   применение   в   игрострой   простой   слово   мы   рассматривать   теория   и   практика   а   в   качество   пример   написать   небольшой   утилита   для   балансировка   игра   уровень   подготовка   если   за   плечо   уже   быть   змейка   и   тетрис   читать   смело   если   нет   ничто   страшный   расширять   кругозор   также   желательный   базовый   знание   LUA   для   понимание   код   итак   поехать   теоретический   часть   наверняка   многие   уже   не   раз   слышать   про   генетический   алгоритм   и   с   что   они   есть   что   далеко   ходить   у   мы   даже   быть   небольшой   статья   в   раздел   термин   генетический   алгоритм   но   сегодня   разговор   не   о   теоретический   а   практический   сторона   вопрос   как   все   этот   безобразие   можно   пускать   в   дело   для   начинать   попробовать   простой   слово   рассказывать   что   же   из   себя   представлять   этот   хитрый   алгоритм   если   максимально   упрощенно   генетический   алгоритм   ничто   иной   как   подбор   коэффициент   для   решение   уравнение   весь   соль   крыться   в   способ   подбор   этот   параметр   тут   то   мы   и   вспоминать   про   название   алгоритм   представлять   искомый   коэффициент   как   ген   и   вспомнить   как   работать   эволюция   еще   в   далекий   время   дарвин   говорить   про   естественный   отбор   что   всегда   выживать   самый   приспособлять   вот   так   же   и   у   мы   алгоритм   до   неприличие   простой   1   создавать   новый   поколение   популяция   2   отбирать   самый   приспособлять   остальной   удалять   3   из   оставаться   выводить   селекционировать   новый   поколение   и   снова   пункт   2   и   весь   это   происходить   до   тот   пора   пока   не   быть   находить   решение   задача   простой   пример   уравнение   X   Y   100   здесь   X   и   Y   можно   представлять   как   ген   создавать   4   особь   со   случайный   набор   ген   X   2   Y   2   X   20   Y   2   X   30   Y   50   X   22   Y   44   проверять   приспособленность   для   это   считать   насколько   переменный   приближать   мы   к   решение   уравнение   2   2   100   0   04   20   2   100   0   22   30   50   100   0   8   22   44   100   0   66   на   основа   хороший   пара   создавать   следующий   поколение   также   добавлять   в   он   и   хороший   особь   из   предыдущий   у   мы   крайне   простой   случай   у   каждый   особь   все   по   2   гена   скрещивать   X1   Y1   и   X2   Y2   и   получать   в   итог   X1   Y2   и   X2   Y1   новый   поколение   X   30   Y   50   родитель   1   X   22   Y   44   родитель   2   X   30   Y   44   потомок   1   X   22   Y   50   потомок   2   и   казаться   бы   вот   уже   мы   скакать   верхом   на   эволюционный   процесс   и   весь   задача   мы   по   плечо   но   не   все   так   просто   на   данный   пример   видно   что   уже   через   1   итерация   новый   ген   взять   неоткуда   а   из   старый   уже   находить   хороший   комбинация   решение   достигать   не   быть   и   система   работать   без   изменение   тут   то   мы   на   помощь   приходить   мутация   они   не   такой   красивый   как   скажем   в   сталкер   но   зато   очень   даже   эффективный   суть   мутация   простой   добавлять   новый   ген   при   формирование   следующий   популяция   быть   это   совершенно   новый   особь   или   изменение   случайный   ген   потомок   уже   деталь   реализация   но   как   говориться   и   это   еще   не   все   при   большой   количество   ген   система   пора   приходить   к   равновесие   так   и   не   находить   решение   и   даже   мутация   из   за   малый   удельный   вес   не   спасать   ситуация   в   качество   аналогия   можно   приводить   новичок   приходить   в   большой   компания   у   он   гореть   глаз   полно   энергия   идея   инновационный   технология   он   кричать   я   знать   как   правильно   как   мы   улучшать   компания   достигать   успех   даже   быть   опыт   а   с   другой   сторона   бывалый   дядя   который   весь   жизнь   тут   трудиться   и   знать   как   делать   дело   у   они   связь   авторитет   они   сидеть   на   откат   и   не   хотеть   ничто   менять   и   они   он   говорить   ты   кто   такой   ващ   ты   мы   мать   что   ли   че   учить   то   мы   вздумать   уходить   не   мешать   работать   а   далеко   система   либо   он   ломать   либо   он   уходить   и   чтобы   эволюция   не   буксовать   на   место   нужный   встряска   как   с   динозавр   например   как   только   происходить   застой   появляться   стабильный   генотип   весь   система   нужный   встряска   удаление   больший   часть   популяция   или   даже   полностью   весь   и   создание   недостающий   особь   со   случайный   набор   ген   опять   же   аналогия   с   компания   большой   компания   поделить   рынок   поровну   и   все   доставаться   понемногу   рынок   не   развиваться   и   тут   приходить   стартапа   состоять   из   тот   самый   молодчик   с   горящий   глаз   конечно   только   один   из   сто   в   итог   оставаться   на   плав   а   остальной   потопать   но   тот   кто   смочь   сорвать   куш   итак   ребятишки   давать   подводить   итог   что   же   сегодня   мы   узнавать   для   работа   генетический   алгоритм   нужный   следующий   вещь   описывать   решение   задача   набор   параметр   ген   называть   это   описание   особь   определять   критерий   успешность   особь   мера   правильность   решение   задача   проводить   эволюционный   отбор   при   помощь   3х   метод   скрещивание   мутация   и   встряска   практический   часть   формула   и   циферка   эта   конечно   хорошо   но   как   говориться   близко   к   тело   быть   задача   с   который   часто   встречаться   как   разработчик   так   и   игрок   а   именно   расчет   билд   для   простота   принимать   что   игра   пошаговый   быть   монстр   у   он   нет   хп   и   мы   быть   измерять   максимально   урон   который   герой   мочь   наносить   пока   не   погибать   каждый   3   ход   монстр   атаковать   игрок   с   20   шанс   крит   быть   игрок   со   следующий   параметр   шкала   здоровье   и   сила   реген   здоровье   и   сила   атака   и   защита   также   у   игрок   быть   экипировка   который   влиять   на   параметр   в   качество   ген   здесь   быть   выступать   экипировка   что   и   в   какой   слот   находиться   у   герой   рука   меч1   атака   5   требовать   сила   5   меч2   атака   4   требовать   сила   3   меч3   атака   8   требовать   сила   10   щит1   защита   3   требовать   сила   2   щит2   защита   5   требовать   сила   3   туловище   доспех1   защита   5   атака   2   доспех2   защита   3   атака   0   доспех3   защита   1   реген   здоровье   1   голова   шлем   защита   2   шапка   сила   реген   сила   1   шапка   здоровье   реген   здоровье   1   макс   здоровье   500   макс   сила   100   реген   здоровье   0   реген   сила   5   атака   1   защита   1   монстр   атаковать   за   раз   на   25   единица   во   время   крит   на   45   шанс   крит   20   игрок   атаковать   каждый   ход   когда   хватать   сила   кодить   весь   это   дело   быть   на   луа   почему   да   это   быстро   и   весело   для   начало   прописывать   параметр   персонаж   монстр   и   экипировка   входной   данные   скрывать   PlayerDefaultParam   HealthMax   500   Health   500   HealthRegen   0   EnergyMax   100   Energy   100   EnergyRegen   5   Attack   1   Defence   1   AttackEnergyUse   0   MonstrParam   AtkDelay   3   Attack   25   AttackCrit   45   CritChancePersent   20   ArmEquip   Name   sword1   Param   Attack   5   AttackEnergyUse   5   Name   sword2   Param   Attack   4   AttackEnergyUse   3   Name   sword3   Param   Attack   8   AttackEnergyUse   10   Name   shield1   Param   Defence   3   AttackEnergyUse   2   Name   shield2   Param   Defence   5   AttackEnergyUse   3   BodyEquip   Name   armor1   Param   Defence   5   AttackEnergyUse   5   Name   armor2   Param   Defence   3   Name   armor3   Param   Defence   1   HealthRegen   1   HeadEquip   Name   helmet _ armor   Param   Defence   2   Name   helmet _ energy   Param   EnergyRegen   1   Name   helmet _ health   Param   HealthRegen   1   теперь   когда   с   входной   данные   заканчивать   идти   далеко   первый   дело   мы   нужно   сгенерировать   особь   то   быть   создавать   случайный   билд   для   это   написать   небольшой   функция   CreateRandomBuild   скрывать   function   CreateRandomBuild   local   Result   Result   Param   for   ParamName   Value   in   pairs   PlayerDefaultParam   do   Result   Param   ParamName   Value   end   Result   Equipment   EquipTable   ArmEquip   EquipIndex   math   random   ArmEquip   EquipTable   ArmEquip   EquipIndex   math   random   ArmEquip   EquipTable   BodyEquip   EquipIndex   math   random   BodyEquip   EquipTable   HeadEquip   EquipIndex   math   random   HeadEquip   SetEquipmentToBuild   Result   return   Result   end   копировать   параметр   заданный   по   умолчание   в   новый   билд   далеко   устанавливать   в   слот   экипировка   здесь   вместо   готовый   таблица   устанавливать   ссылка   на   исходный   таблица   и   генерировать   в   ее   предел   случайный   индекс   это   мы   понадобиться   для   селекция   перед   то   как   вернуть   создавать   билд   добавлять   параметр   из   экипировка   в   параметр   сам   билд   это   делаться   небольшой   функция   SetEquipmentToBuild   Build   скрывать   function   SetEquipmentToBuild   Build   for  _  Equipment   in   pairs   Build   Equipment   do   local   EquipmentParam   Equipment   EquipTable   Equipment   EquipIndex   Param   for   ParamName   Value   in   pairs   EquipmentParam   do   Build   Param   ParamName   Build   Param   ParamName   Value   end   end   end   теперь   нужный   способ   скрещивание   особь   так   как   ген   у   мы   это   просто   индекс   массив   то   скрещивание   быть   представлять   из   себя   случайный   выбор   гена   у   один   из   особь   родитель   ну   и   чтоб   ускорять   эволюция   немного   один   из   особь   доминантный   быть   иметь   больший   шанс   6   из   10   передавать   свой   ген   CrossingBuils   Build1   Build2   скрывать   function   CrossingBuils   Build1   Build2   local   Result   Result   Param   for   ParamName   Value   in   pairs   PlayerDefaultParam   do   Result   Param   ParamName   Value   end   Result   Equipment   for   I   1   Build1   Equipment   do   local   DominantGeneChance   6   6   10   if   math   random   10   DominantGeneChance   then   Result   Equipment   I   EquipTable   Build1   Equipment   I   EquipTable   EquipIndex   Build1   Equipment   I   EquipIndex   else   Result   Equipment   I   EquipTable   Build2   Equipment   I   EquipTable   EquipIndex   Build2   Equipment   I   EquipIndex   end   end   local   MutationChance   2   2   10   if   math   random   10   MutationChance   and   Build1   Build2   then   local   Ind   math   random   Result   Equipment   Result   Equipment   Ind   EquipIndex   math   random   Result   Equipment   Ind   EquipTable   end   SetEquipmentToBuild   Result   return   Result   end   также   во   избежание   вырождение   популяция   добавлять   шанс   мутация   2   из   10   в   наш   случай   мутация   случайный   изменение   один   из   ген   слот   экипировка   добавлять   параметр   экипировка   к   билд   и   готовый   еще   мы   понадобиться   функция   оценка   жизнеспособность   билд   писать   TestBattle   Build   скрывать   function   TestBattle   Build   local   TotalDamage   0   local   BattleStep   0   while   Build   Param   Health   0   do   BattleStep   BattleStep   1   if   Build   Param   Energy   Build   Param   AttackEnergyUse   then   Build   Param   Energy   Build   Param   Energy   Build   Param   AttackEnergyUse   TotalDamage   TotalDamage   Build   Param   Attack   end   if   BattleStep   MonstrParam   AtkDelay   0   then   local   MonstrAttack   MonstrParam   Attack   if   math   random   100   MonstrParam   CritChancePersent   then   MonstrAttack   MonstrParam   AttackCrit   end   Build   Param   Health   Build   Param   Health   math   max   0   MonstrAttack   Build   Param   Defence   end   Build   Param   Health   math   min   Build   Param   HealthMax   Build   Param   Health   Build   Param   HealthRegen   Build   Param   Energy   math   min   Build   Param   EnergyMax   Build   Param   Energy   Build   Param   EnergyRegen   if   BattleStep   9999   then   break   end   end   return   TotalDamage   BattleStep   end   оценивать   быть   по   максимальный   наносить   урон   также   не   лишний   быть   знать   сколько   на   это   потребоваться   шаг   на   каждый   шаг   мы   делать   следующий   вещь   если   достаточно   энергия   атаковать   если   ход   кратный   три   получать   урон   от   монстр   с   20   шанс   крит   провожать   регенерация   здоровье   и   энергия   проверять   вдруг   билд   получаться   крутой   монстр   ограничивать   весь   это   дело   10000   итерация   в   итог   возвращать   наносить   урон   и   продолжительность   битва   итак   весь   приготовление   сделать   и   приходить   время   окунаться   в   увлекательный   мир   генетический   алгоритм   вы   готовый   ребенок   а   вот   и   сам   генетический   алгоритм   подгребать   к   наш   праздник   невежество   и   знание   GenTest   скрывать   function   GenTest   local   PopulationCount   16   Builds   for   I   1   PopulationCount   do   Builds   I   CreateRandomBuild   end   local   GenerationCount   50   for   GenerationInd   1   GenerationCount   do   BuildsBattleResult   for   I   1   Builds   do   local   TotalDamage   BattleStep   TestBattle   Builds   I   BuildsBattleResult   I   Build   Builds   I   Damage   TotalDamage   BattleLenght   BattleStep   end   table   sort   BuildsBattleResult   function   A   B   return   A   Damage   B   Damage   end   local   NewBuilds   local   ParentCount   PopulationCount   2   for   I   1   ParentCount   do   table   insert   NewBuilds   CrossingBuils   BuildsBattleResult   I   Build   BuildsBattleResult   I   Build   table   insert   NewBuilds   CrossingBuils   BuildsBattleResult   I   Build   BuildsBattleResult   I   ParentCount   Build   end   Builds   NewBuilds   print   GenerationInd   GenerationInd   dmg   BuildsBattleResult   1   Damage   tsteps   t   BuildsBattleResult   1   BattleLenght   end   for  _  Build   in   pairs   BuildsBattleResult   1   Build   Equipment   do   print   Build   EquipTable   Build   EquipIndex   Name   end   end   создавать   таблица   и   заполнять   случайный   билд   размер   популяция   быть   выбирать   в   16   особь   далее   весь   популяция   проходить   проверка   бой   и   сортироваться   по   наносить   урон   переходить   к   селекция   ген   хороший   половина   популяция   переходить   в   следующий   поколение   после   что   начинать   скрещивать   успешный   половина   с   тот   кто   отбор   так   и   не   проходить   в   этот   же   момент   мочь   происходить   мутация   в   итог   мы   получать   количество   особь   что   быть   в   начало   и   опять   бой   селекция   бой   казаться   бы   все   это   мочь   длиться   вечно   но   на   небольшой   количество   ген   хороший   комбинация   находиться   довольно   быстро   поэтому   у   мы   стоять   ограничение   в   50   цикл   после   что   можно   подводить   итог   для   запуск   весь   это   мракобесие   оставаться   только   взводить   рандомизатор   по   текущий   время   и   запускать   симуляция   math   randomseed   os   time   GenTest   сохранять   запускать   затаивать   дыхание   ждать   результат   и   вуаль   видеть   что   самый   хороший   билд   это   два   второе   меч   доспех   номер   3   и   шапка   жизнь   запускать   симуляция   еще   несколько   раз   подряд   видно   что   этот   билд   являться   стабильный   но   все   же   иногда   быть   небольшой   отклонение   это   получаться   за   счет   небольшой   количество   поколение   и   рандома   связывать   с   критический   атака   монстр   при   увеличение   количество   поколение   до   500   билд   получаться   всегда   один   и   тот   же   поэтому   для   балансировка   важно   правильно   подбирать   количество   итерация   вот   сводный   график   3х   запуск   моделирование   зависимость   наносить   урон   от   поколение   особь   высокий   старт   весь   случай   обусловливать   то   что   это   результат   хороший   особь   первый   поколение   основной   часть   эволюция   происходить   в   течение   первый   20   цикл   после   уже   видный   стабилизация   снижать   количество   поколение   до   10   можно   увидеть   и   другой   жизнеспособный   вариант   что   интересно   в   они   ни   раз   не   быть   щит   а   значит   они   нуждаться   в   ребаланс   тот   же   при   помощь   этот   алгоритм   можно   определять   средний   время   жизнь   монстр   а   если   немного   переделывать   то   появляться   возможность   сталкивать   билд   друг   с   друг   вывод   подводить   итог   у   мы   получаться   за   небольшой   время   сделать   довольно   гибкий   инструмент   для   балансировка   игра   который   помогать   проверять   работать   ли   все   как   задумывать   или   быть   место   который   стоить   поправлять   правда   в   пример   не   быть   использовать   механизм   встряска   из   за   малый   количество   ген   его   эффект   быть   бы   просто   незаметный   надеяться   еще   рассказывать   вы   об   это   но   это   уже   быть   совсем   другой   история   а   пока   весь   хороший   и   спасибо   за   рыба   20   март   2018   обновление   31   дека   2018   комментарий   62   убирать   реклама   контакт   сообщество   участник   каталог   сайт   категория   архив   новость   GameDev   ru   разработка   игра   2001   2019